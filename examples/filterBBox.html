<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-beta.1/leaflet.css"/>
  <style>
    html, body, #map {
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>
  <title>Leaflet-WFST bbox filter demo</title>
</head>
<body>
<div id="map"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-beta.1/leaflet-src.js"></script>

<script src="lib/proj4-compressed.js"></script>
<script src="lib/proj4leaflet.js"></script>

<script src="../dist/Leaflet-WFST.src.js"></script>
<script>
  var map = L.map('map').setView([0, 0], 12);
  // add an OpenStreetMap tile layer
  L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
  }).addTo(map);

  var objWfst = {
    url: 'http://geoserver.ics.perm.ru/geoserver/ows',
    typeNS: 'osm_perm_region',
    typeName: 'perm_water_polygon',
    crs: L.CRS.EPSG4326,
    geometryField: 'ogr_geometry',
    filter: new L.Filter.BBox().append(map.getBounds(), 'ogr_geometry', L.CRS.EPSG4326),
    style: {
      color: 'blue',
      weight: 2
    }
  };

  var wfst = new L.WFST(objWfst).addTo(map);

  map.on('moveend',function(){
    wfst.clearLayers();
    objWfst.filter = new L.Filter.BBox().append(map.getBounds(), 'ogr_geometry', L.CRS.EPSG4326);
    wfst = new L.WFST(objWfst).addTo(map);
  })

</script>
</body>
</html>
